# Cost Guard 触发率验证报告

**测试时间:** 2025-07-09 17:05:39
**目标要求:** FP < 2%, TP > 95%

## 配置测试结果

| 配置名称 | FP率 | TP率 | 要求达成 | 参数设置 |
|----------|------|------|----------|----------|
| Baseline | 0.000% | 96.781% | ✅ 通过 | ws=10, th=1000, sens=0.8 |
| Conservative | 49.462% | 100.000% | ❌ 失败 | ws=5, th=500, sens=0.9 |
| Aggressive | 0.000% | 96.781% | ✅ 通过 | ws=15, th=1500, sens=0.7 |
| Optimized | 0.000% | 98.069% | ✅ 通过 | ws=8, th=800, sens=0.85 |
| Balanced | 0.000% | 96.781% | ✅ 通过 | ws=12, th=1200, sens=0.75 |
| High_Sensitivity | 27.742% | 100.000% | ❌ 失败 | ws=6, th=600, sens=0.95 |
| Low_Sensitivity | 0.000% | 22.961% | ❌ 失败 | ws=20, th=2000, sens=0.6 |

## 测试总结

- **测试配置总数:** 7
- **通过配置数量:** 4
- **成功率:** 57.1%

### 推荐配置

**Baseline** 配置提供最优性能:

- 窗口大小: 10 秒
- Token速率阈值: 1000
- 模式敏感度: 0.8
- 误报率 (FP): 0.000%
- 检出率 (TP): 96.781%
- 总体准确率: 98.389%

## 参数调优记录

### 窗口大小影响分析
- 5秒: 0% 成功率
- 6秒: 0% 成功率
- 8秒: 100% 成功率
- 10秒: 100% 成功率
- 12秒: 100% 成功率
- 15秒: 100% 成功率
- 20秒: 0% 成功率

### Token速率阈值影响分析
- 500: 0% 成功率
- 600: 0% 成功率
- 800: 100% 成功率
- 1000: 100% 成功率
- 1200: 100% 成功率
- 1500: 100% 成功率
- 2000: 0% 成功率

### 模式敏感度影响分析
- 0.6: 0% 成功率
- 0.7: 100% 成功率
- 0.75: 100% 成功率
- 0.8: 100% 成功率
- 0.85: 100% 成功率
- 0.9: 0% 成功率
- 0.95: 0% 成功率

## 调试建议

**若 FP > 2%，建议:**
- 增大 window_size（如 5s → 10s）
- 提高 token_rate_threshold（如 500 → 1000）
- 降低 pattern_sensitivity（如 0.9 → 0.8）

**若 TP < 95%，建议:**
- 检查正则匹配逻辑（sidecar.py 中的 detect_token_storm）
- 提高 pattern_sensitivity（如 0.7 → 0.8）
- 降低 token_rate_threshold（如 1000 → 800）


---
*报告生成时间: 2025-07-09 17:05:39*
